<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <script type="application/ld+json">

{  
  "@context":"http://schema.org",
  "@type":"Website",
  "@id":"https:\/\/beastlyprime.github.io\/",
  "author": {
    "@type": "Person",
    "name": "Yimeng Chen",
    
    "image": "https://beastlyprime.github.io/images/author.jpg"
    
  },
  "name":"Yimeng Chen\u0027s site",
  "description":"\u003cp\u003eThis paper studies the geometrical properties of the representations learned by neural networks. Published at NeurIPS 2019.\u003c\/p\u003e",
  "url":"https:\/\/beastlyprime.github.io\/2022\/06\/intrinsic-dimension-of-data-representations-in-deep-neural-networks\/",
  "keywords":"[Representations, Intrinsic Dimension of Data Representations, blog, machine-learning, yimeng-chen]"
}

</script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.74.3 with theme Tranquilpeak 0.5.3-BETA">
<meta name="author" content="Yimeng Chen">
<meta name="keywords" content="Representations, Intrinsic Dimension of Data Representations, blog, machine-learning, yimeng-chen">
<meta name="description" content="This paper studies the geometrical properties of the representations learned by neural networks. Published at NeurIPS 2019.">


<meta property="og:description" content="This paper studies the geometrical properties of the representations learned by neural networks. Published at NeurIPS 2019.">
<meta property="og:type" content="article">
<meta property="og:title" content="Intrinsic Dimension of Data Representations in Deep Neural Networks">
<meta name="twitter:title" content="Intrinsic Dimension of Data Representations in Deep Neural Networks">
<meta property="og:url" content="https://beastlyprime.github.io/2022/06/intrinsic-dimension-of-data-representations-in-deep-neural-networks/">
<meta property="twitter:url" content="https://beastlyprime.github.io/2022/06/intrinsic-dimension-of-data-representations-in-deep-neural-networks/">
<meta property="og:site_name" content="Yimeng Chen&#39;s site">
<meta property="og:description" content="This paper studies the geometrical properties of the representations learned by neural networks. Published at NeurIPS 2019.">
<meta name="twitter:description" content="This paper studies the geometrical properties of the representations learned by neural networks. Published at NeurIPS 2019.">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2022-06-21T00:00:00">
  
  
    <meta property="article:modified_time" content="2022-06-21T00:00:00">
  
  
  
    
      <meta property="article:section" content="Machine Learning">
    
  
  
    
      <meta property="article:tag" content="paper-learning">
    
  


<meta name="twitter:card" content="summary">







  <meta property="og:image" content="https://beastlyprime.github.io/images/author.jpg">
  <meta property="twitter:image" content="https://beastlyprime.github.io/images/author.jpg">





  <meta property="og:image" content="https://beastlyprime.github.io/images/IntrinsicD.jpg">
  <meta property="twitter:image" content="https://beastlyprime.github.io/images/IntrinsicD.jpg">


    <title>Intrinsic Dimension of Data Representations in Deep Neural Networks</title>

    <link rel="icon" href="https://beastlyprime.github.io/favicon.png">
    

    

    <link rel="canonical" href="https://beastlyprime.github.io/2022/06/intrinsic-dimension-of-data-representations-in-deep-neural-networks/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    
    
    <link rel="stylesheet" href="https://beastlyprime.github.io/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css" />
    
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://beastlyprime.github.io/" aria-label="Go to homepage">Yimeng Chen&#39;s site</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://beastlyprime.github.io/#about" aria-label="Open the link: /#about">
    
    
    
      
        <img class="header-picture" src="https://beastlyprime.github.io/images/author.jpg" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://beastlyprime.github.io/#about" aria-label="Read more about the author">
          <img class="sidebar-profile-picture" src="https://beastlyprime.github.io/images/author.jpg" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Yimeng Chen</h4>
        
          <h5 class="sidebar-profile-bio">A bird in the forest of AI.</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://beastlyprime.github.io/" title="Home">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://beastlyprime.github.io/categories" title="Categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://beastlyprime.github.io/tags" title="Tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://beastlyprime.github.io/archives" title="Archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://beastlyprime.github.io/#about" title="About">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://beastlyprime.github.io/index.xml" title="RSS">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post" id="top">
          
          
            <div class="post-header main-content-wrap text-center">
  
    <h1 class="post-title">
      Intrinsic Dimension of Data Representations in Deep Neural Networks
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2022-06-21T00:00:00Z">
        
  June 21, 2022

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="https://beastlyprime.github.io/categories/machine-learning">Machine Learning</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              <p>This paper studies the geometrical properties of the representations learned by neural networks. Published at NeurIPS 2019.</p>
<p><em>Intrinsic dimension</em> (ID) is viewed as a fundamental geometric property of a data representation in a neural network. Informally, it is the minimal number of coordinates which are necessary to describe its points without significant information loss. This paper introduces some existing observations on the ID of some neural networks:</p>
<ul>
<li>Linear estimates of ID on simplified models and local estimates of ID have been developed.</li>
<li>Local ID has been shown correlates with the adversarial robustness. Lower local ID -&gt; higher robustness.</li>
<li>Local ID at several locations on the tangent space of object manifolds are estimated, and found decrease along the last hidden layers of AlexNet.</li>
<li>Local ID in the last layer of DNNs has been found to be much lower than the dimension of the embedding space.</li>
<li>Some linear and nonlinear dimensionality reduction techniques have been developed.</li>
</ul>
<p>This paper aims to answer:</p>
<ul>
<li>How the ID changes alongs the layer of CNNs?</li>
<li>How different is the actual ID from the &lsquo;linear&rsquo; dimensionality of a network?</li>
<li>How is the ID relates to the generalization performance?</li>
</ul>
<p>They uses an existing method, TwoNN, to estimate global ID. It exploits the fact that nearest-neighbour statistics depend on the ID. Based on TwoNN, The answers are shown to be:</p>
<ul>
<li>The variation of the ID along the hidden layers of CNNs follows a similar trend across different architectures: increase in early layers, then monotonically decrease.</li>
<li>ID of CNNs are typically several orders of magnitude lower than the dimensionality of the embedding space (the number of units in a layer).</li>
<li>In networks trained to classify images, the ID of the training set in the last hidden layer can accurately predicts the network’s classification accuracy on the test set: the lower the better. ID remains high for a network trained on non predictable data (i.e., with permuted labels).</li>
</ul>
<p>These observations seem to be consistent with our intuition of ID. Now we study how the ID is calculated in this paper.</p>
<h2 id="estimating-the-id-by-twonn">Estimating the ID by TwoNN</h2>
<p>TwoNN <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> is based on computing the ratio between the distances to the second and first nearest neighbors (NN) of each data point. It can be applied even if the manifold containing the data is curved, topologically complex, and sampled non-uniformly.</p>
<p><strong>The assumption of TwoNN</strong>: the density is constant on the scale of the distance between each point and its second nearest neighbor.</p>
<p><img src="https://beastlyprime.github.io/images/TwoNN.png" alt="TwoNN"></p>
<p>Let points $x_i$ be uniformly sampled on a manifold with intrinsic dimension $d$ and let $N$ be the total number of points. The algorithm of TwoNN consists of the following steps:</p>
<ul>
<li>
<p>For each data point $i$ compute the distance to its first and second neighbour $r_i^{(1)}$and $r_i^{(2)}$, as shown in the figure above.</p>
</li>
<li>
<p>Compute the ratio $\mu_i =  r_i^{(2)} / r_i^{(1)}$. It follows a Pareto distribution with parameter $d+1$ on $[1, +\infty]$. $P(\mu) = \frac{d}{\mu^{1+d}}$.  ${\mu_i}$  are assumed $i.i.d.$.</p>
</li>
<li>
<p>Infer $d$ by maximizing the empirical likelihood:
$$
P(\boldsymbol{\mu} \mid d)=d^{N} \prod_{i=1}^{N} \mu_{i}^{-(d+1)}
$$</p>
</li>
<li>
<p>Repeat the calculation selecting a fraction of points at random. This gives the ID as a function of the scale of the distances.</p>
</li>
</ul>
<p>It is introduced in this paper that:</p>
<ol>
<li>The ID can also be estimated by restricting the product in the above equation to non-intersecting triplets of points, for which independence is strictly satisfied, but, as shown in the paper <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>, in practice this does not significantly affect the estimate.</li>
<li>The ID estimated by this approach is asymptotically correct even for samples harvested from highly non-uniform probability distributions.</li>
<li>When ID is smaller than 20, the estimated values remain very close with finite samples; when larger ∼ 20, the estimated values should be considered as lower bounds.</li>
<li>ID should be at least approximately scale invariant. To test that, they systematically decimating the dataset, thus gradually reducing its size and the average distance between data points had become progressively larger.</li>
</ol>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>E. Facco, M. d’Errico, A. Rodriguez, and A. Laio, “Estimating the intrinsic dimension of datasets by a minimal neighborhood information,” <em>Scientific reports</em>, vol. 7, no. 1, p. 12140, 2017. <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>
              


            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://beastlyprime.github.io/tags/paper-learning/">paper-learning</a>

                  </div>
                
              
            
            
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://beastlyprime.github.io/2022/06/welcome-about-me/" data-tooltip="Welcome &amp; About Me" aria-label="NEXT: Welcome &amp; About Me">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://beastlyprime.github.io/2022/03/causally-motivated-shortcut-removal-using-auxiliary-labels/" data-tooltip="Causally Motivated Shortcut Removal Using Auxiliary Labels" aria-label="PREVIOUS: Causally Motivated Shortcut Removal Using Auxiliary Labels">
          
              <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://beastlyprime.github.io/2022/06/intrinsic-dimension-of-data-representations-in-deep-neural-networks/" title="Share on Facebook" aria-label="Share on Facebook">
          <i class="fa-facebook-official" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://beastlyprime.github.io/2022/06/intrinsic-dimension-of-data-representations-in-deep-neural-networks/" title="Share on Twitter" aria-label="Share on Twitter">
          <i class="fa-twitter" aria-hidden="true"></i>
        </a>
      </li>
    
  
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="Back to top">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


            
  


          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2022 Yimeng Chen. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://beastlyprime.github.io/2022/06/welcome-about-me/" data-tooltip="Welcome &amp; About Me" aria-label="NEXT: Welcome &amp; About Me">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://beastlyprime.github.io/2022/03/causally-motivated-shortcut-removal-using-auxiliary-labels/" data-tooltip="Causally Motivated Shortcut Removal Using Auxiliary Labels" aria-label="PREVIOUS: Causally Motivated Shortcut Removal Using Auxiliary Labels">
          
              <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://beastlyprime.github.io/2022/06/intrinsic-dimension-of-data-representations-in-deep-neural-networks/" title="Share on Facebook" aria-label="Share on Facebook">
          <i class="fa-facebook-official" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://beastlyprime.github.io/2022/06/intrinsic-dimension-of-data-representations-in-deep-neural-networks/" title="Share on Twitter" aria-label="Share on Twitter">
          <i class="fa-twitter" aria-hidden="true"></i>
        </a>
      </li>
    
  
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="Back to top">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


      </div>
      
<div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-times"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fbeastlyprime.github.io%2F2022%2F06%2Fintrinsic-dimension-of-data-representations-in-deep-neural-networks%2F" aria-label="Share on Facebook">
          <i class="fa-facebook-official" aria-hidden="true"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fbeastlyprime.github.io%2F2022%2F06%2Fintrinsic-dimension-of-data-representations-in-deep-neural-networks%2F" aria-label="Share on Twitter">
          <i class="fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>


    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-times"></i>
    </div>
    
      <img id="about-card-picture" src="https://beastlyprime.github.io/images/author.jpg" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Yimeng Chen</h4>
    
      <div id="about-card-bio">A bird in the forest of AI.</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        PhD candidate
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker-alt"></i>
        <br/>
        Beijing, China
      </div>
    
  </div>
</div>

    

    
  
    
      <div id="cover" style="background-image:url('https://beastlyprime.github.io/images/cover.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js" integrity="sha512-z+/WWfyD5tccCukM4VvONpEtLmbAm5LDu7eKiyMQJ9m7OfPEDL7gENyDRL3Yfe8XAuGsS2fS4xSMnl6d30kqGQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<script src="https://beastlyprime.github.io/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js"></script>



<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full" integrity="sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=" crossorigin="anonymous"></script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      CommonHTML: { linebreaks: { automatic: true } },
      tex2jax: { inlineMath: [ ['$', '$'], ['\\(','\\)'] ], displayMath: [ ['$$','$$'], ['\\[', '\\]'] ], processEscapes: false },
      messageStyle: 'none'
    });
  </script>



    
  </body>
</html>

